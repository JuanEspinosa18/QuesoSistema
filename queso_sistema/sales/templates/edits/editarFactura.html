{% extends "edits/editarbase.html" %} 
{% block content%}
<style>
  #content-main {
    margin: 20px;
  }

  .object-tools {
    margin-bottom: 20px;
  }

  .object-tools .historylink {
    color: blue;
  }

  fieldset.module {
    border: 1px solid #ccc;
    padding: 10px;
    margin-bottom: 20px;
  }

  .form-row {
    margin-bottom: 15px;
  }

  .flex-container {
    display: flex;
    align-items: center;
  }

  label {
    margin-right: 10px;
  }

  input[type="text"],
  input[type="number"] {
    padding: 5px;
    border: 1px solid #ccc;
    border-radius: 5px;
  }

  .submit-row {
    margin-top: 20px;
  }

  .submit-row input[type="submit"],
  .submit-row a {
    padding: 10px 20px;
    border-radius: 5px;
  }

  .submit-row input[type="submit"] {
    background-color: #00563f;
    color: white;
    border: none;
    cursor: pointer;
  }

  .submit-row input[type="submit"]:hover {
    background-color: #00472e;
  }

  .deletelink {
    margin-left: 20px;
    color: red;
  }
</style>
<br><br><br><br>
<div id="content-main">
  <h1>Modificar Factura</h1>
  <form method="POST" id="factura_form" novalidate="">
    {% csrf_token %}
    <div>
      <fieldset class="module aligned">
        <div class="form-row field-name">
          <div>
            <div class="flex-container">
              <label class="required" for="id_name">Nombre:</label>
              <input
                type="text"
                name="name"
                value="{{ factura.name }}"
                class="vTextField"
                maxlength="200"
                required=""
                id="id_name"
              />
            </div>
          </div>
        </div>

        <div class="form-row field-fecha_factura">
          <div>
            <div class="flex-container">
              <label class="required">Fecha de factura:</label>
              <p class="datetime">
                Fecha:
                <input
                  type="date"
                  name="fecha_factura_0"
                  value="{{ factura.fecha_factura|date:'Y-m-d' }}"
                  class="vDateField"
                  size="10"
                  required=""
                  id="id_fecha_factura_0"
                />
                <br />
                Hora:
                <input
                  type="time"
                  name="fecha_factura_1"
                  value="{{ factura.fecha_factura|time:'H:i:s' }}"
                  class="vTimeField"
                  size="8"
                  required=""
                  id="id_fecha_factura_1"
                />
              </p>
            </div>
          </div>
        </div>

        <div class="form-row field-subtotal">
          <div>
            <div class="flex-container">
              <label class="required" for="id_subtotal">Subtotal:</label>
              <input
                type="number"
                name="subtotal"
                value="{{ factura.subtotal }}"
                step="0.01"
                required=""
                id="id_subtotal"
              />
            </div>
          </div>
        </div>

        <div class="form-row field-iva">
          <div>
            <div class="flex-container">
              <label class="required" for="id_iva">IVA:</label>
              <input
                type="number"
                name="iva"
                value="{{ factura.iva }}"
                step="0.01"
                required=""
                id="id_iva"
              />
            </div>
          </div>
        </div>

        <div class="form-row field-total">
          <div>
            <div class="flex-container">
              <label class="required" for="id_total">Total:</label>
              <input
                type="number"
                name="total"
                value="{{ factura.total }}"
                step="0.01"
                required=""
                id="id_total"
                readonly
              />
            </div>
          </div>
        </div>
      </fieldset>
      <div class="submit-row">
        <input type="submit" value="Guardar" class="btn btn-success" name="_save" />
        <a class="btn btn-danger" href="{% url 'DashVentas' %}">Cancelar</a>
      </div>
    </div>
  </form>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const subtotalInput = document.getElementById('id_subtotal');
    const ivaInput = document.getElementById('id_iva');
    const totalInput = document.getElementById('id_total');

    function calculateTotal() {
      const subtotal = parseFloat(subtotalInput.value) || 0;
      const iva = parseFloat(ivaInput.value) || 0;
      const total = subtotal + iva;
      totalInput.value = total.toFixed(2);
    }

    subtotalInput.addEventListener('input', calculateTotal);
    ivaInput.addEventListener('input', calculateTotal);

    // Initial calculation if values are pre-filled
    calculateTotal();
  });
</script>
{% endblock %}
